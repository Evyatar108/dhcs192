# coding=utf-8
from contntprvdrs.chapterstring import StringContentProvider
from contntprvdrs.royalroad import RoyalRoadContentProvider
from novelanalyze import infoextrct
from novelanalyze.contntprvdr import ContentProviderBase
from visual import grphnet


def extract_relations_graph(content_provider: ContentProviderBase):
    novel_entities = infoextrct.extract_entities(content_provider)
    grphnet.show_relations_network_graph(novel_entities)


if __name__ == "__main__":
    provider = StringContentProvider('test string','Ichi sweated in the summer heat, stumbling home afterschool. He thought about the cute girls in class, as always. The twins who were aloof, the two younger girls who made him think about having a daughter someday, and then there was the one who couldn\'t leave Ichi alone on the way to school, Renya. Renya walked him to school everyday. She\'d talk to him about love. Then, once they got to the school, Renya would leave him and go do math alone. Ichi couldn\'t fathom what she was thinking, playing around like that. Ichi knew Reyna was lying to him. Ichi could smell it on her. Ichi looked at the forest, far away across the heated rice paddys. Perhaps he\'d go today as well? Grandpa would bother him about coming home late, but Ichi didn\'t let Grandpa stop him as he walked towards the broad green band in the distance. The sun passed down into sunset as he walked touching each tree as he did, feeling the cracks in the bark as he passed. Amber light filtered through the green foliage. Ichi knew the time to go home had come, but something within said, "just for today." Ichi took off into the depths of the forest, farther than Ichi ever went before. Ichi knew how to navigate the forest by instinct. How well he find a certain tree. How many things he could locate by smell alone. With people, he got the sense they were lying by their smell. He shrugged it off, but it bothered him. Ichi came upon a waterfall by a cave. He smelled it when he came to the forest before, but Grandpa always told him, "Don\'t go too deep, you\'ll get eaten by an evil spirit." Picking up a stick and trimming it, he swung it around like a sword. Ichi watched the waterfall trickle down fierce and rush into the river below as he swung down mimicking it\'s force. I am the current of the river, I am the flow in the water, I am the leaf on the wind, Ichi chanted to himself. Acting like he was doing kendo training Ichi imagined himself as a samurai in the old movies he\'d watch on Grandpa\'s VHS player. All Ichi had at home was the VHS player and old books lying around. At least his school didn\'t have homework. Ichi swore as he swung down, someday, I\'ll get my smartphone back, and then I\'ll take over the world, and then I\'ll find my dad in hell and punch him in the face for leaving Mom alone. Like he could. Ichi got pulled into this village by a bunch of thugs in the night. Couldn\'t fight back much. A samurai would have gone down fighting. Would a samurai have submitted to them to avoid violence? Ichi got one with a left kick to the head. Looked at him pissed, then his consciousness flickered out. Would a samurai have killed them with no effort? Then, he would track down the villain behind it all and brought him to justice. At the end of a swordpoint. After all, the samurai would only have protected his peaceful life. It\'s not much of a story if there\'s nothing to protect. Where\'s the women? Samurai needs a woman floating three steps behind him, Ichi nodded. A yowling meow echoed out. Ichi got the scent of blood in his nose. Wiping his face with his sleeve, his head cocked to listen. Ichi ran into the forest, wooden sword in hand. Ichi wasn\'t a samurai, but he could act like one. Crashing through the foliage he swung the sword cutting bushes cracking twigs into the air. Breaking into an amber lit clearing, he saw across the tall grass a black bear. Ichi\'s sense of logic told him to run. Ichi\'s grip tightened on his sword. Another meow sounded out, then a flash of light blinded him. Spears of light floated in the air, striking down on the bear like rain. They melted on the bear\'s fur, dissipating into sparks. The wind shifted. The bear turned and shifted it\'s head towards Ichi. Ichi\'s short hair flowed in the wind. A rumble echoed out from the bear, a deep thick voice like a samurai. "Leave, Tanuki. This matter is not yours." Ichi ran forward. Never seen a talking bear outside of a cartoon or anime, he thought. Tanuki? Him? A racoon-dog? Being insulted by a bear is unbearable, Ichi joked as he charged. A grin cut across his face as he sped at the bear with his wooden sword held aloft. "Very well. Count yourself one of the fools who this Mountain Lord has slain. You will number but one among the many," the bear rumbled. Ichi saw a white and black cat with two tails swishing around run in front as if to block him. Ichi stopped, wondering how fun today could get. If he went insane, he figured, at least that\'s an improvement over his old life. The white and black spotted like a cow cat had deep gashes across her flank. "This isn\'t your fight, Tanuki! I will live or die on my own merits!" The cat meowed at him in a feminine feline voice. "I\'m no tanuki. I\'m Ichi. Nice to meet you, talking cat." Ichi laughed as he eyed the Mountain Lord who stared with void pupils at the two. Ichi crouched and petted the cat\'s head, slinging his sword over his shoulder. The cat arched it\'s back to Ichi\'s touch. "Don\'t touch me, filthy tanuki! You will be next!" "You gonna survive and kill this bear, and then me, and then what?" Ichi chided her. The cat relaxed her arched back. "And then, freedom!" The Mountain Lord rose behind her and swiped down. Ichi saw black carpet blocking out the sun, and he snagged the cat and rolled out of the way. Then, his body dodged back. Ichi felt the air pressure hum as sword claws grazed his cheek, stinging him. Ichi backed away as the Mountain Lord advanced on him, then a massive golden shield shined into existence in front of the bear blocking him. Rising to it\'s hind legs the bear swung back his paw fully, crashing it down on the shield cracking it. Ichi took that as a signal to run as he heard furious blows echo out against the shield. He looked back at the flurry of blows the Mountain Lord unleashed, wishing he\'d listened to Grandpa for once.')
    extract_relations_graph(provider)
